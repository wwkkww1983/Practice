/*!
 * ljl@2018
 */
!function(n,t,i){var u=top,f=u.layer,r={t:(new Date).getTime(),BASE_URL:"http://localhost:62192/"};r.encode=function(n){return JSON.stringify(n)};r.decode=function(n){return JSON.parse(n)};r.queryString=function(n,t){t=t||location.search;var i=t.match(new RegExp("[?&]"+n+"=([^&]+)","i"));return i==null||i.length<1?"":i[1]};r.api=function(i,u,f,e){typeof u=="function"&&(e=f,f=u,u={});var o=/^\s*get:/.test(i)?"get":"post",s=r.BASE_URL+i.replace(/^\s*(post:|get:)?\s*\/?/,"");return n.ajax(n.extend({type:o,url:s,dataType:"json",contentType:"application/json",data:o=="post"?r.encode(u):u,beforeSend:function(n){n.setRequestHeader("Authorization","Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE1Njc4NDY2ODYsInVzZXIiOnsiVXNlcklEIjoiMSIsIlVzZXJOYW1lIjoi6LaF57qn566h55CG5ZGYIn19.U4mnFIJpioXChcKIBD29MLx1UL-NfPiK6hM1XVrw2U8")},success:function(n){n.Code==401&&(t.location.href="/login?returnUrl="+encodeURIComponent(t.location.href));var i;(f&&(i=f(n)),i!==!1)&&(i!==!0||n.Code)&&r.msg(n)},error:function(n){var t={Code:n.status||1,Message:n.statusText||n.responseText||"error"};f&&f(t)===!1;r.msg(t)}},e))};r.loader=function(t,i){return function(u,f,e){i&&(u=typeof i=="function"?n.extend(u,i(u)):n.extend(u,i));r.api(t,u,function(n){return n.Code?e(n):f(n.Data),!0})}};r.filter=function(t){var i=[];return n(t).find("input[type=hidden]").each(function(){var t=n(this),f=t.val(),r,u;f&&(r=t.parent(),u={name:t.attr("name"),value:f,type:"like"},(r.hasClass("datebox")||r.hasClass("combo"))&&(u.type="="),i.push(u))}),{filters:i}};r.getFormData=function(t){var u={},i=n(t),f=!0,r;if(i.find(".validatebox-text:not(:disabled)").validatebox("validate"),r=i.find(".validatebox-invalid"),r.filter(":not(:disabled):first").focus(),r.length>0){f=!1;return}return i.find("input[type=hidden]").each(function(){var t=n(this),i=t.val(),r=t.attr("name");u[r]=i}),u};r.setFormData=function(t,i){var r=n(t);r.form("load",i)};r.export=function(t){var f=n(t),i;f.datagrid("loading");var r=f.datagrid("options"),e={page:r.pageNumber,rows:r.pageSize,sort:r.sortName,order:r.sortOrder,columns:[]},u=r.columns[0];for(i=0;i<u.length;i++)u[i].checkbox||e.columns.push({width:u[i].width,field:u[i].field,title:u[i].title});alert(JSON.stringify(e));f.datagrid("loaded")};r._layerList=[];r.load=function(){f.load()};r.unload=function(){f.closeAll("loading")};r.msg=function(n,t){var i=n;typeof i=="string"&&(i={Message:n,Code:t});layer.open({skin:"layui-layer-msg",icon:i.Code===0?1:i.Code===1?2:0,title:!1,closeBtn:!1,area:["25%",""],btn:!1,shade:!1,time:6e3,content:i.Message,anim:4})};r.confirm=function(n,t){layer.confirm(n,{btn:["确认","取消"],title:"提示",icon:2,skin:"lr-layer"},function(n){t(!0,n);layer.close(n)},function(n){t(!1,n);layer.close(n)})};r.open=function(t){var r,e,o;t=n.extend({type:2,shadeClose:!1,shade:[.2,"#fff"],max:!0,reload:!0,area:["700px","70%"]},t);r=[];t.fit&&r.push(function(n,t){f.iframeAuto(t)});t.success&&r.push(t.success);r.length>0&&(t.success=function(t,i){var f=u[t.find("iframe")[0].name];n.each(r,function(n,r){r.call(this,t,i,f)})});e=t.end;t.end=function(n){n===i&&u.site._layerList.pop();e&&e.call(this,n)};o=f.open(t);u.site._layerList.push(o)};r.close=function(n){var t=u.site._layerList.pop();!t||f.close(t,n)};t.site=r}(jQuery,window);